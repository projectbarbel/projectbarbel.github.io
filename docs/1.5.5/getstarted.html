<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Get started with POJOs · BarbelHisto</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;&lt;a href=&quot;https://github.com/projectbarbel/barbelhisto-core/blob/master/src/test/java/org/projectbarbel/histo/BarbelHistoCore_StdPojoUsage_Test.java&quot;&gt;See this test case&lt;/a&gt; to get the complete code for this tutorial.&lt;/p&gt;
"/><meta name="docsearch:version" content="1.5.5"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Get started with POJOs · BarbelHisto"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.projectbarbel.org/index.html"/><meta property="og:description" content="&lt;p&gt;&lt;a href=&quot;https://github.com/projectbarbel/barbelhisto-core/blob/master/src/test/java/org/projectbarbel/histo/BarbelHistoCore_StdPojoUsage_Test.java&quot;&gt;See this test case&lt;/a&gt; to get the complete code for this tutorial.&lt;/p&gt;
"/><meta property="og:image" content="https://www.projectbarbel.org/img/logo_blau_weiss_klein.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://www.projectbarbel.org/img/logo_blau_weiss_klein.png"/><link rel="shortcut icon" href="/img/small_barbel.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-135274031-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/small_barbel.png" alt="BarbelHisto"/><h2 class="headerTitleWithLogo">BarbelHisto</h2></a><a href="/versions"><h3>1.5.5</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/1.5.5/about" target="_self">Docs</a></li><li class=""><a href="/help" target="_self">Help</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Documentation</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">BarbelHisto<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/1.5.5/about">About</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/license">License</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/download">Download</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Documentation<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/docs/1.5.5/getstarted">Get started with POJOs</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/bitemporal">Mode BITEMPORAL</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/timeshift">Journey through time</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/persistence">Adding persistence</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/indexing">Adding indexes</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/events">Using events</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/customization">Customizing BarbelHisto</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Persistence<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/1.5.5/mongo">Integrating MongoDB</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Project Details<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/1.5.5/support">Getting Support</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/acknowledge">Acknowledgements</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/repo">Source Repository</a></li><li class="navListItem"><a class="navItem" href="/docs/1.5.5/releasenotes">Release Notes</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Get started with POJOs</h1></header><article><div><span><p><a href="https://github.com/projectbarbel/barbelhisto-core/blob/master/src/test/java/org/projectbarbel/histo/BarbelHistoCore_StdPojoUsage_Test.java">See this test case</a> to get the complete code for this tutorial.</p>
<blockquote>
<p><strong>NOTE</strong>: in this turorial we use <code>BarbelHisto</code>s default processing mode, which is <code>BarbelMode.POJO</code>. There is another mode called <code>BarbelMode.BITEMPORAL</code> if proxying does not work out on your business classes.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="create-an-instance-of-barbelhisto"></a><a href="#create-an-instance-of-barbelhisto" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create an instance of BarbelHisto</h2>
<p>Create an instance of <code>BarbelHisto</code>.</p>
<pre><code class="hljs css language-java">BarbelHisto<span class="token generics function"><span class="token punctuation">&lt;</span>Employee<span class="token punctuation">></span></span> core <span class="token operator">=</span> BarbelHistoBuilder<span class="token punctuation">.</span><span class="token function">barbel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="store-and-retrieve-a-version"></a><a href="#store-and-retrieve-a-version" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Store and retrieve a version</h2>
<p>You're ready to store instances of <code>Employee</code> to your <code>BarbelHisto</code> instance.</p>
<pre><code class="hljs css language-java">Employee employee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"somePersonelNumber"</span><span class="token punctuation">,</span> <span class="token string">"Niklas"</span><span class="token punctuation">,</span> <span class="token string">"Schlimm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
core<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>employee<span class="token punctuation">,</span> LocalDate<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LocalDate<span class="token punctuation">.</span>MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>In the <code>Employee.class</code> you need to specify the <code>@DocumentId</code> so that <code>BarbelHisto</code>can group versions to a document journal. In the <code>Employee.class</code> the <code>personnelNumber</code> is the document ID.</p>
<pre><code class="hljs css language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
   <span class="token annotation punctuation">@DocumentId</span>
   <span class="token keyword">private</span> String personnelNumber<span class="token punctuation">;</span> 
   <span class="token keyword">private</span> String firstname<span class="token punctuation">;</span> 
   <span class="token keyword">private</span> String lastname<span class="token punctuation">;</span>
   <span class="token keyword">private</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>Adress<span class="token punctuation">></span></span> adresses <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> constructor and accessor methods
<span class="token punctuation">}</span>
</code></pre>
<p>The document ID must be unique for the document from a business viewpoint. An employee can be uniquely identified by his personnel number. <br>
If you want to retrieve your current <code>Employee</code> version, you can do that by calling <code>retrieveOne</code>on <code>BarbelHisto</code>.</p>
<pre><code class="hljs css language-java">Employee effectiveEmployeeVersion <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">retrieveOne</span><span class="token punctuation">(</span>BarbelQueries<span class="token punctuation">.</span><span class="token function">effectiveNow</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Notice that you need to tell <code>BarbelHisto</code> what effective date your looking for. In the query above you're looking for the <code>Employee</code> version effective now (today). You can also ask for a specific date in the past or in the future.</p>
<pre><code class="hljs css language-java">Employee effectiveIn10Days <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">retrieveOne</span><span class="token punctuation">(</span>BarbelQueries<span class="token punctuation">.</span><span class="token function">effectiveAt</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span>personnelNumber<span class="token punctuation">,</span> LocalDate<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>That query retrieves the <code>Employee</code> version effective in ten days. It will return one, cause you've stored the <code>Employee</code> version to be effective from now to infinite (<code>LocalDate.MAX</code>). If you retrieve the <code>Employee</code> effective yesterday you'll receive a <code>NoSuchElementException</code> claiming that no value can be found. This strict treatment is to avoid <code>NullPointerException</code> somewhere later in the process. However, this query throws an exception, cause nothing was effective yesterday:</p>
<pre><code class="hljs css language-java">Employee effectiveYesterday <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">retrieveOne</span><span class="token punctuation">(</span>BarbelQueries<span class="token punctuation">.</span><span class="token function">effectiveAt</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span>personnelNumber<span class="token punctuation">,</span> LocalDate<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">minusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="accessing-bitemporal-version-metadata"></a><a href="#accessing-bitemporal-version-metadata" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Accessing bitemporal version metadata</h2>
<p>Whenever you receive data from <code>BarbelHisto</code> with <code>retrieve</code>-methods all the objects carry a <code>BitemporalStamp</code> as version stamp. This stamp contains all the version data for that object. You can receive that as follows:</p>
<pre><code class="hljs css language-java">BitemporalStamp versionData <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Bitemporal<span class="token punctuation">)</span>effectiveEmployeeVersion<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBitemporalStamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>That <code>BitemporalStamp</code> contains the effective time and record time data for that given object.</p>
<blockquote>
<p>Casting is only required in <code>BarbelMode.POJO</code> as proxies are returned from the <code>BarbelHisto</code> instance. If you use <code>BarbelMode.BITEMPORAL</code> you get the <code>BitemporalStamp</code> by calling the <code>getBitemporalStamp()</code> method.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="printing-pretty-journals"></a><a href="#printing-pretty-journals" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Printing pretty journals</h2>
<p>Let's look at a pretty print of a document journal for a document ID. The pretty print shows what <code>BarbelHisto</code> knows about your data. It prints out the version data of of the given document ID in a table format.</p>
<pre><code class="hljs css language-java">System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>core<span class="token punctuation">.</span><span class="token function">prettyPrintJournal</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>That prints the following to your console.</p>
<p><strong>NOTE: when I wrote this Readme.md it was 2019 February the 15th</strong></p>
<pre><code class="hljs"><span class="hljs-attribute">Document-ID</span>: somePersonelNumber

<span class="gherkin">|<span class="hljs-string">Version-ID                              </span>|<span class="hljs-string">Effective-From </span>|<span class="hljs-string">Effective-Until </span>|<span class="hljs-string">State   </span>|<span class="hljs-string">Created-By           </span>|<span class="hljs-string">Created-At                                   </span>|<span class="hljs-string">Inactivated-By       </span>|<span class="hljs-string">Inactivated-At                               </span>|<span class="hljs-string">Data                           </span>|
|<span class="hljs-string">----------------------------------------</span>|<span class="hljs-string">---------------</span>|<span class="hljs-string">----------------</span>|<span class="hljs-string">--------</span>|<span class="hljs-string">---------------------</span>|<span class="hljs-string">---------------------------------------------</span>|<span class="hljs-string">---------------------</span>|<span class="hljs-string">---------------------------------------------</span>|<span class="hljs-string">-------------------------------</span>|
|<span class="hljs-string">226ab05c-7c2d-4746-8861-18dc85a0188e    </span>|<span class="hljs-string">2019-02-15     </span>|<span class="hljs-string">999999999-12-31 </span>|<span class="hljs-string">ACTIVE  </span>|<span class="hljs-string">SYSTEM               </span>|<span class="hljs-string">2019-02-15T08:46:56.495+01:00[Europe/Berlin] </span>|<span class="hljs-string">NOBODY               </span>|<span class="hljs-string">2199-12-31T23:59:00Z                         </span>|<span class="hljs-string">EffectivePeriod [from=2019-02- </span>|
</span></code></pre>
<p>You can change the pretty printer and write your own. Look into <code>TableJournalPrettyPrinter</code> to see how to write an individual printer. You can register that printer with <code>BarbelHistoBuilder</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="make-a-bitemporal-update"></a><a href="#make-a-bitemporal-update" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Make a bitemporal update</h2>
<p>So far you know how to store POJOs to <code>BarbelHisto</code>. The real power of <code>BarbelHisto</code> is, however, to store changes to your <code>Employee</code> that become effective in the future (or became effective in the past). Here is how simple such an update works.
Let's retrieve a copy of our current employee version. (<strong>clients only ever retrieve copies!</strong>)</p>
<pre><code class="hljs css language-java">Employee effectiveEmployeeVersion <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">retrieveOne</span><span class="token punctuation">(</span>BarbelQueries<span class="token punctuation">.</span><span class="token function">effectiveNow</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now suppose that the employee marries in 10 days, and that is supposed to become the day when the last name has to change.</p>
<pre><code class="hljs css language-java">effectiveEmployeeVersion<span class="token punctuation">.</span><span class="token function">setLastname</span><span class="token punctuation">(</span><span class="token string">"changedLastName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
core<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>effectiveEmployeeVersion<span class="token punctuation">,</span> LocalDate<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LocalDate<span class="token punctuation">.</span>MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Done. <code>BarbelHisto</code> now knows about that change, it will make a snapshot and store that internally. You could safely continue to work with your employee version and save that again later. <br>
If you retrieve versions now, you may become different states of the employee, since you've recorded a change.</p>
<pre><code class="hljs css language-java">effectiveEmployeeVersion <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">retrieveOne</span><span class="token punctuation">(</span>BarbelQueries<span class="token punctuation">.</span><span class="token function">effectiveNow</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
effectiveIn10Days <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">retrieveOne</span><span class="token punctuation">(</span>BarbelQueries<span class="token punctuation">.</span><span class="token function">effectiveAt</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span>personnelNumber<span class="token punctuation">,</span> LocalDate<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertTrue</span><span class="token punctuation">(</span>effectiveEmployeeVersion<span class="token punctuation">.</span><span class="token function">getLastname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Schlimm"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertTrue</span><span class="token punctuation">(</span>effectiveIn10Days<span class="token punctuation">.</span><span class="token function">getLastname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"changedLastName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The <code>effectiveEmployeeVersion</code> is that version you've stored in the beginning of this tutorial, the <code>effectiveIn10Days</code> version will be the one with the changed last name. <br>
Let's also have a look at the pretty print of that journal now. Again call:</p>
<pre><code class="hljs css language-java">System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>core<span class="token punctuation">.</span><span class="token function">prettyPrintJournal</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>That should return the following journal now.</p>
<pre><code class="hljs"><span class="hljs-attribute">Document-ID</span>: somePersonelNumber

<span class="angelscript">|Version-ID                              |Effective-From |Effective-Until |State   |Created-By           |Created-At                                   |Inactivated-By       |Inactivated-At                               |Data                           |
|----------------------------------------|---------------|----------------|--------|---------------------|---------------------------------------------|---------------------|---------------------------------------------|-------------------------------|
|<span class="hljs-number">226</span>ab05c<span class="hljs-number">-7</span>c2d<span class="hljs-number">-4746</span><span class="hljs-number">-8861</span><span class="hljs-number">-18</span>dc85a0188e    |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>     |<span class="hljs-number">999999999</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span> |INACTIVE|SYSTEM               |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T08:<span class="hljs-number">46</span>:<span class="hljs-number">56.495</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>[Europe/Berlin] |SYSTEM               |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T08:<span class="hljs-number">46</span>:<span class="hljs-number">56.546</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>[Europe/Berlin] |EffectivePeriod [<span class="hljs-keyword">from</span>=<span class="hljs-number">2019</span><span class="hljs-number">-02</span>- |
|c2d8a5b8-a8cf<span class="hljs-number">-4f</span>19-aeb4<span class="hljs-number">-4</span>ca61b4f8f70    |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>     |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-25</span>      |ACTIVE  |SYSTEM               |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T08:<span class="hljs-number">46</span>:<span class="hljs-number">56.541</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>[Europe/Berlin] |NOBODY               |<span class="hljs-number">2199</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>T23:<span class="hljs-number">59</span>:<span class="hljs-number">00</span>Z                         |EffectivePeriod [<span class="hljs-keyword">from</span>=<span class="hljs-number">2019</span><span class="hljs-number">-02</span>- |
|c9302f79<span class="hljs-number">-9</span>c7b<span class="hljs-number">-4</span>b4a-b011<span class="hljs-number">-8</span>bb6177278af    |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-25</span>     |<span class="hljs-number">999999999</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span> |ACTIVE  |SYSTEM               |<span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T08:<span class="hljs-number">46</span>:<span class="hljs-number">56.536</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>[Europe/Berlin] |NOBODY               |<span class="hljs-number">2199</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>T23:<span class="hljs-number">59</span>:<span class="hljs-number">00</span>Z                         |EffectivePeriod [<span class="hljs-keyword">from</span>=<span class="hljs-number">2019</span><span class="hljs-number">-02</span>- |
</span></code></pre>
<p>As you can see the journal of that employee now contains three versions. Two versions with <code>ACTIVE</code> state and one with <code>INACTIVE</code> state. The active versions are effective from 2019-02-15 (today) and effective from 2019-02-25. There is one inactivated version, the one you've stored in the beginning of that tutorial, effective from 2019-02-15 until <code>LocalDate.MAX</code>. <code>BarbelHisto</code> manages two time dimensions, one reflects the effective time, and another one, redord time, reflects when a change was made. For that reason, <strong>nothing will ever be deleted</strong>. There are <strong>only inserts</strong> to <code>BarbelHiso</code> backbone collections, <strong>never deletions</strong>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/1.5.5/download"><span class="arrow-prev">← </span><span>Download</span></a><a class="docs-next button" href="/docs/1.5.5/bitemporal"><span>Mode BITEMPORAL</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#create-an-instance-of-barbelhisto">Create an instance of BarbelHisto</a></li><li><a href="#store-and-retrieve-a-version">Store and retrieve a version</a></li><li><a href="#accessing-bitemporal-version-metadata">Accessing bitemporal version metadata</a></li><li><a href="#printing-pretty-journals">Printing pretty journals</a></li><li><a href="#make-a-bitemporal-update">Make a bitemporal update</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/small_barbel.png" alt="BarbelHisto" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/getstarted.html">Getting Started</a></div><div><h5>Community</h5><a href="https://github.com/projectbarbel/barbelhisto-core/issues">Report issue</a></div><div><h5>More</h5><a href="https://github.com/projectbarbel/barbelhisto-core">GitHub</a><a class="github-button" href="https://github.com/projectbarbel/barbelhisto-core" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="BarbelHisto">Star</a></div></section><section class="copyright">Copyright © 2019 Niklas Schlimm</section></footer></div></body></html>